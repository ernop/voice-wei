<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Voice-Wei: Voice-controlled scale practice for singers and musicians">
    <meta name="robots" content="noindex, nofollow">
    <title>Scales - Voice-Wei</title>
    <link rel="stylesheet" href="style.css?v=29">
    <link rel="stylesheet" href="scales.css?v=29">
</head>

<body>
    <div class="container">
        <header>
            <div class="header-top">
                <h1>Scales</h1>
                <span class="version-label">v0.29</span>
                <nav class="nav-tabs">
                    <a href="scales.html" class="nav-tab active">Scales</a>
                    <a href="pitch-meter.html" class="nav-tab">Pitch</a>
                    <a href="player.html" class="nav-tab">Music</a>
                    <a href="ebook.html" class="nav-tab">Books</a>
                </nav>
            </div>
        </header>

        <main>
            <div class="voice-controls-row">
                <button id="listenBtn" class="listen-button" aria-label="Start listening">
                    <span class="button-text">Listen</span>
                    <span class="button-icon">&#9835;</span>
                </button>
                <button id="stopBtn" class="stop-button" aria-label="Stop playback">
                    <span class="button-text">Stop</span>
                    <span class="button-icon">&#9632;</span>
                </button>
                <button id="againBtn" class="play-button" aria-label="Play">
                    <span class="button-text">Play</span>
                    <span class="button-icon">&#9654;</span>
                </button>
                <button id="submitBtn" class="submit-button-large" style="display: none;"
                    aria-label="Submit">Submit</button>
            </div>

            <div class="transcript-container" id="transcriptContainer" style="display: none;">
                <p class="transcript-label">You said:</p>
                <p class="transcript" id="transcript"></p>
            </div>

            <!-- Piano Keyboard -->
            <div class="piano-container">
                <div class="piano-notification-area" id="pianoNotificationArea">
                    <table class="piano-notification-table" aria-label="Piano notification">
                        <tr>
                            <td class="piano-notification-command-cell">
                                <div class="piano-notification-command" id="pianoNotificationCommand">
                                </div>
                            </td>
                            <td class="piano-notification-note-cell empty" id="pianoNotificationNote1"></td>
                            <td class="piano-notification-note-cell empty" id="pianoNotificationNote2"></td>
                            <td class="piano-notification-note-cell empty" id="pianoNotificationNote3"></td>
                            <td class="piano-notification-note-cell empty" id="pianoNotificationNote4"></td>
                            <td class="piano-notification-note-cell empty" id="pianoNotificationNote5"></td>
                            <td class="piano-notification-note-cell empty" id="pianoNotificationNote6"></td>
                        </tr>
                    </table>
                </div>
                <div class="piano-keys" id="pianoKeys"></div>
            </div>

            <!-- Note Sequence Preview (hidden by default, toggle via Show Sequence) -->
            <div class="sequence-grid" id="sequenceGridContainer" style="display: none">
                <span class="note-sequence-label">Sequence:</span>
                <code class="note-sequence" id="noteSequence">--</code>
                <span class="note-sequence-label">Played:</span>
                <code class="note-sequence" id="actuallyPlayed">--</code>
            </div>

            <!-- Voice-First Scale Builder - All Bidirectional Controls -->
            <div class="voice-first-ui">
                <p class="vf-instruction" id="vfInstruction" style="display: none">Say any option below to set it, or
                    click directly. <button class="vf-dismiss" id="dismissInstruction">x</button></p>

                <div class="vf-row">
                    <span class="vf-label" data-full="Root" data-abbr="Rt">Root</span>
                    <div class="vf-options">
                        <button class="vf-btn" data-root="C">C</button>
                        <button class="vf-btn vf-btn-sharp" data-root="C#">C#</button>
                        <button class="vf-btn" data-root="D">D</button>
                        <button class="vf-btn vf-btn-sharp" data-root="D#">D#</button>
                        <button class="vf-btn" data-root="E">E</button>
                        <button class="vf-btn" data-root="F">F</button>
                        <button class="vf-btn vf-btn-sharp" data-root="F#">F#</button>
                        <button class="vf-btn" data-root="G">G</button>
                        <button class="vf-btn vf-btn-sharp" data-root="G#">G#</button>
                        <button class="vf-btn" data-root="A">A</button>
                        <button class="vf-btn vf-btn-sharp" data-root="A#">A#</button>
                        <button class="vf-btn" data-root="B">B</button>
                    </div>
                    <span class="vf-label vf-label-inline" data-full="Octave" data-abbr="Oct">Octave</span>
                    <div class="vf-options">
                        <button class="vf-btn" data-octave="3">3</button>
                        <button class="vf-btn" data-octave="4">4</button>
                    </div>
                </div>

                <div class="vf-row">
                    <span class="vf-label" data-full="Scale" data-abbr="Scl">Scale</span>
                    <div class="vf-options">
                        <button class="vf-btn" data-scale-type="major" data-full="major" data-abbr="Maj">major</button>
                        <button class="vf-btn" data-scale-type="minor" data-full="minor" data-abbr="min">minor</button>
                        <button class="vf-btn" data-scale-type="chromatic" data-full="chromatic"
                            data-abbr="Chr">chromatic</button>
                        <button class="vf-btn" data-scale-type="pentatonic" data-full="pentatonic"
                            data-abbr="Pent">pentatonic</button>
                        <button class="vf-btn" data-scale-type="harmonic_minor" data-full="h minor"
                            data-abbr="Hmin">h minor</button>
                        <button class="vf-btn" data-scale-type="melodic_minor" data-full="m minor"
                            data-abbr="Mmin">m minor</button>
                    </div>
                </div>

                <div class="vf-row">
                    <span class="vf-label" data-full="Move" data-abbr="Mv">Move</span>
                    <div class="vf-options">
                        <button class="vf-btn" data-movement="normal" data-full="normal" data-abbr="-">normal</button>
                        <button class="vf-btn" data-movement="stop_and_go" data-full="+1+2"
                            data-abbr="+1+2">+1+2</button>
                        <button class="vf-btn" data-movement="one_three_five" data-full="1-3-5"
                            data-abbr="1-3-5">1-3-5</button>
                        <button class="vf-btn" data-movement="neighbors" data-full="neighbors (dir)"
                            data-abbr="Nbr">neighbors</button>
                        <button class="vf-btn" data-movement="chords" data-full="chords" data-abbr="Chd">chords</button>
                        <button class="vf-btn" data-movement="from_one" data-full="from 1" data-abbr="fr1">from
                            1</button>
                        <button class="vf-btn" data-movement="to_one" data-full="to 1" data-abbr="to1">to
                            1</button>
                        <button class="vf-btn" data-movement="plus_minus_one" data-full="+1-1"
                            data-abbr="+1-1">+1-1</button>
                    </div>
                </div>

                <div class="vf-row">
                    <span class="vf-label" data-full="Note Length" data-abbr="Len">Note Length</span>
                    <div class="vf-options">
                        <button class="vf-btn" data-length-ms="100">0.1s</button>
                        <button class="vf-btn" data-length-ms="150">0.15s</button>
                        <button class="vf-btn" data-length-ms="300">0.3s</button>
                        <button class="vf-btn" data-length-ms="500">0.5s</button>
                        <button class="vf-btn" data-length-ms="800">0.8s</button>
                        <button class="vf-btn" data-length-ms="1000">1s</button>
                        <button class="vf-btn" data-length-ms="1500">1.5s</button>
                        <button class="vf-btn" data-length-ms="2000">2s</button>
                        <button class="vf-btn" data-length-ms="3000">3s</button>
                        <button class="vf-btn" data-length-ms="5000">5s</button>
                    </div>
                </div>

                <div class="vf-row">
                    <span class="vf-label" data-full="Direction" data-abbr="Dir">Direction</span>
                    <div class="vf-options">
                        <button class="vf-btn" data-direction="ascending" data-full="up" data-abbr="u">up</button>
                        <button class="vf-btn" data-direction="descending" data-full="down" data-abbr="d">down</button>
                        <button class="vf-btn" data-direction="both" data-full="up+down"
                            data-abbr="u+d">up+down</button>
                        <button class="vf-btn" data-direction="down_and_up" data-full="down+up"
                            data-abbr="d+u">down+up</button>
                    </div>
                </div>

                <div class="vf-row">
                    <span class="vf-label" data-full="Repeat" data-abbr="Rep">Repeat</span>
                    <div class="vf-options">
                        <button class="vf-btn" data-repeat="1" data-full="once" data-abbr="1x">once</button>
                        <button class="vf-btn" data-repeat="2" data-full="twice" data-abbr="2x">twice</button>
                        <button class="vf-btn" data-repeat="Infinity" data-full="&#8734;"
                            data-abbr="&#8734;">&#8734;</button>
                        <button class="vf-btn" data-repeat="Infinity-nogap" data-full="&#8734;+no gap"
                            data-abbr="&#8734; 0g">&#8734;+no gap</button>
                    </div>
                    <span class="vf-label vf-label-inline" data-full="Rising" data-abbr="Ris">Rising</span>
                    <div class="vf-options">
                        <button class="vf-btn" data-rising="0" data-full="off" data-abbr="off">off</button>
                        <button class="vf-btn" data-rising="1" data-full="half" data-abbr="m2">half</button>
                        <button class="vf-btn" data-rising="2" data-full="whole" data-abbr="M2">whole</button>
                    </div>
                </div>

                <div class="vf-row">
                    <span class="vf-label" data-full="Exercise" data-abbr="Ex">Exercise</span>
                    <div class="vf-options">
                        <button class="vf-btn" data-exercise="none" data-full="full scale" data-abbr="-">full scale</button>
                        <button class="vf-btn" data-exercise="five_note" data-full="5-note warmup" data-abbr="5nt">5-note</button>
                        <button class="vf-btn" data-exercise="octave_jump" data-full="octave jump" data-abbr="8va">oct jump</button>
                        <button class="vf-btn" data-exercise="arpeggio_return" data-full="arp return" data-abbr="arp">arp return</button>
                        <button class="vf-btn" data-exercise="thirds" data-full="thirds" data-abbr="3rds">thirds</button>
                    </div>
                    <span class="vf-label vf-label-inline" data-full="Shifting" data-abbr="Shf">Shifting</span>
                    <div class="vf-options">
                        <button class="vf-btn" data-shifting="0" data-full="off" data-abbr="off">off</button>
                        <button class="vf-btn" data-shifting="1" data-full="on" data-abbr="on">on</button>
                    </div>
                </div>

                <div class="vf-row">
                    <span class="vf-label" data-full="Section Width" data-abbr="Wid">Section Width</span>
                    <div class="vf-options">
                        <button class="vf-btn" data-section-length="1o" data-full="1 octave" data-abbr="1o">1
                            octave</button>
                        <button class="vf-btn" data-section-length="1o+3" data-full="octave+3rd"
                            data-abbr="1o+3">octave+3rd</button>
                        <button class="vf-btn" data-section-length="1o+5" data-full="octave+5th"
                            data-abbr="1o+5">octave+5th</button>
                        <button class="vf-btn" data-section-length="2o" data-full="2 octaves" data-abbr="2o">2
                            octaves</button>
                    </div>
                </div>

                <div class="vf-row">
                    <span class="vf-label" data-full="Note Gap" data-abbr="Gap">Note Gap</span>
                    <div class="vf-options">
                        <button class="vf-btn" data-gap-value="-0.5">-50%</button>
                        <button class="vf-btn" data-gap-value="-0.1">-10%</button>
                        <button class="vf-btn" data-gap-value="-0.05">-5%</button>
                        <button class="vf-btn" data-gap-value="0">0s</button>
                        <button class="vf-btn" data-gap-value="50">0.05s</button>
                        <button class="vf-btn" data-gap-value="100">0.1s</button>
                        <button class="vf-btn" data-gap-value="150">0.15s</button>
                        <button class="vf-btn" data-gap-value="300">0.3s</button>
                        <button class="vf-btn" data-gap-value="500">0.5s</button>
                        <button class="vf-btn" data-gap-value="1000">1s</button>
                    </div>
                </div>

                <div class="vf-row vf-row-reset">
                    <span class="vf-label"></span>
                    <div class="vf-options">
                        <button id="resetBtn" class="vf-reset-btn">Reset</button>
                        <button id="randomBtn" class="vf-reset-btn">Random</button>
                    </div>
                </div>
            </div>

            <!-- Display Toggles -->
            <div class="display-toggles">
                <label class="display-toggle">
                    <input type="checkbox" id="showSequenceToggle">
                    <span>Show Sequence</span>
                </label>
                <label class="display-toggle">
                    <input type="checkbox" id="useAbbrevToggle">
                    <span>Use Abbreviations</span>
                </label>
                <label class="display-toggle">
                    <input type="checkbox" id="echoCommandsToggle">
                    <span>Echo Commands</span>
                </label>
            </div>

            <!-- Voice Control Commands -->
            <div class="voice-control-commands">
                <span class="vcc-label">Voice controls:</span>
                <code>stop</code>
                <code>play</code>
            </div>

            <!-- Saved Configurations (Presets) -->
            <div class="command-history" id="presetHistory">
                <div class="history-header">
                    <h3>Saved Configs</h3>
                </div>
                <div class="preset-actions-row">
                    <input id="presetNameInput" class="preset-name-input" type="text"
                        placeholder="Name this config (optional)" />
                    <button id="savePresetBtn" class="copy-all-history-btn"
                        title="Save current settings">Save</button>
                    <button id="applyPresetBtn" class="copy-all-history-btn"
                        title="Apply selected config">Apply</button>
                    <button id="deletePresetBtn" class="clear-history-btn"
                        title="Delete selected config">Delete</button>
                </div>
                <div class="history-list" id="presetList">
                    <p class="history-empty">No saved configs yet</p>
                </div>
            </div>

            <!-- Command History -->
            <div class="command-history" id="commandHistory">
                <div class="history-header">
                    <h3>Command History</h3>
                    <div class="history-actions">
                        <button id="copyAllHistoryBtn" class="copy-all-history-btn" title="Copy all history">Copy
                            All</button>
                        <button id="clearHistoryBtn" class="clear-history-btn">Clear</button>
                    </div>
                </div>
                <div class="history-list" id="historyList">
                    <p class="history-empty">No commands yet</p>
                </div>
            </div>

            <!-- Voice Settings (moved to bottom) -->
            <details class="voice-settings-section">
                <summary>Voice Settings</summary>
                <div class="settings-row voice-settings">
                    <div class="setting-group">
                        <label for="voiceSelect">Voice:</label>
                        <select id="voiceSelect">
                            <option value="">Default</option>
                        </select>
                    </div>
                    <div class="setting-group">
                        <label for="voiceRate">Speed:</label>
                        <input type="range" id="voiceRate" min="0.5" max="2" step="0.1" value="1">
                        <span id="voiceRateValue">1x</span>
                    </div>
                    <div class="setting-group">
                        <label for="voicePitch">Pitch:</label>
                        <input type="range" id="voicePitch" min="0.5" max="1.5" step="0.1" value="1">
                        <span id="voicePitchValue">1</span>
                    </div>
                    <button id="testVoiceBtn" class="test-voice-btn">Test</button>
                </div>
            </details>

            <footer class="page-footer">
                <button onclick="location.reload(true)" class="footer-btn">Hard Refresh</button>
                <a href="https://github.com/ernop/voice-wei" target="_blank" class="footer-link">GitHub</a>
            </footer>
        </main>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <script src="music-constants.js?v=29"></script>
    <script src="voice-command-core.js?v=29"></script>
    <script src="scales.js?v=29"></script>
</body>

</html>